# IQLé…ç½® - V å¯¹é½å®éªŒï¼ˆå†»ç»“ Qï¼Œåªè®­ Vï¼‰
# 
# ç›®çš„ï¼š
#   éªŒè¯ V loss å®ç°æ˜¯å¦æ­£ç¡®
#   åœ¨å›ºå®š Q çš„æƒ…å†µä¸‹ï¼ŒV æ˜¯å¦èƒ½æ”¶æ•›åˆ° tau-expectile
#
# å®éªŒè®¾ç½®ï¼š
#   - å®Œå…¨å†»ç»“ Q ç½‘ç»œï¼ˆä¸æ›´æ–°ï¼‰
#   - å®Œå…¨å†»ç»“ Policy ç½‘ç»œï¼ˆä¸æ›´æ–°ï¼‰
#   - åªè®­ç»ƒ V ç½‘ç»œ
#   - è§‚å¯Ÿ Positive% æ˜¯å¦ â†’ 30%
#
# å¦‚æœæˆåŠŸï¼š
#   Positive% åº”ç¨³å®šåœ¨ 28%-32%
#   è¯æ˜ V loss å®ç°æ­£ç¡®
#
# å¦‚æœå¤±è´¥ï¼š
#   è¯´æ˜ V loss æˆ– tau ä¼ å€¼æœ‰é—®é¢˜

data:
  path: intermediate_data/ready_data.csv
  sheet: 0
  state_cols:
    - vanco_level(ug/mL)
    - creatinine(mg/dL)
    - wbc(K/uL)
    - bun(mg/dL)
    - temperature
    - sbp
    - heart_rate

train:
  seed: 42
  total_steps: 5000               # çŸ­æœŸå®éªŒ
  batch_size: 64
  log_interval: 20
  ckpt_interval: 500
  buffer_capacity: 10000
  policy_warmup_steps: 10000      # ğŸ”§ æ°¸è¿œå†»ç»“ policy
  q_warmup_steps: 10000           # ğŸ”§ æ°¸è¿œå†»ç»“ Qï¼ˆéœ€è¦æ·»åŠ æ­¤å‚æ•°æ”¯æŒï¼‰

model:
  hidden: [256, 256]
  lr: 0.0001                      # Q å­¦ä¹ ç‡ï¼ˆä½†ä¸ä¼šç”¨åˆ°ï¼‰
  v_lr_ratio: 0.3                 # V lr = 0.00003
  gamma: 0.99
  tau: 0.7                        # éªŒè¯ï¼šæœŸæœ› 30% positive
  beta: 1.0
  weight_clip: 20.0
  reward_scale: 0.1
  use_target_q: false             # ä¸éœ€è¦ target Qï¼ˆQ ä¸æ›´æ–°ï¼‰
  target_update_rate: 0.005

workdir: algorithms/iql/runs/exp_v_alignment_test

